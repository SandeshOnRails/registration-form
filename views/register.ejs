<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M"
    crossorigin="anonymous">
  <title>Registration Form</title>
</head>

<style>


.capbox {
  background-color: #92D433;
  border: #B3E272 0px solid;
  border-width: 0px 12px 0px 0px;
  display: inline-block;
  *display: inline; zoom: 1; /* FOR IE7-8 */
  padding: 8px 40px 8px 8px;
  }

.capbox-inner {
  font: bold 11px arial, sans-serif;
  color: #000000;
  background-color: #DBF3BA;
  margin: 5px auto 0px auto;
  padding: 3px;
  -moz-border-radius: 4px;
  -webkit-border-radius: 4px;
  border-radius: 4px;
  }

#CaptchaDiv {
  font: bold 17px verdana, arial, sans-serif;
  font-style: italic;
  color: #000000;
  background-color: #FFFFFF;
  padding: 4px;
  -moz-border-radius: 4px;
  -webkit-border-radius: 4px;
  border-radius: 4px;
  }

#CaptchaInput { margin: 1px 0px 1px 0px; width: 135px; }




</style>

<body>

  <nav class="navbar navbar-expand-sm navbar-dark bg-primary mb-3">
  <div class="container">
    <p class='lead'>CSC 642 Summer 2018 Individual Assignment - Sandesh Basnet</p>

    </div>
</nav>

<div class="row">
  <div class="col-md-6 mx-auto">
    <div class="card card-body">

      <h3 class="text-center">Registration Form</h3>
        


      <div style="color:red; padding-top:20px;" id='first_errors'>
        
      </div>

      <div style="color:red; padding-top:20px;" id='last_errors'>
        
      </div>

      <div style="color:red; padding-top:20px;" id='pass_errors'>
        
      </div>

      <hr class="my-4" style=' border: 0;
                                clear:both;
                                display:block;
                                 width: 96%;               
                                 background-color:grey;
                                 height: 1px;'>

      <form name='registration' onsubmit="return checkform(this)" method="post" action='/register'>
        <div class="form-group" >
          <label for="first" id='first_label'>First Name <span id='symbol_first'></span></label>
          <input type="text" class="form-control" name="first" id="first" required>
        </div>
        <div class="form-group">
            <label for="last" id='last_label'>Last Name <span id='symbol_last'></span></label>
          <input type="text" class="form-control" name="last" id="last" required>
        </div>
        <div class="form-group">
          <label for="address">Address</label>
          <input type="text" name="address" class="form-control"  required>
        </div>
        <div class="form-group">
          <label for="email">Education Level</label>
          <select name="education">
           <option value="High School">High School </option>
            <option value="College">College </option>
            <option value="Graduate School">Graduate School </option>
            <option value="PhD">PhD</option>
          </select>
        </div>
         <div class="form-group">
          <label for="income">Yearly Income</label>
          <select name="income">
           <option value="High School">Less than 50,000</option>
            <option value="College">Between 50,000 and 100,000</option>
            <option value="Graduate School">Above 100,000</option>
          </select>
        </div>
        <div class="form-group">
          <label for="password" id="psw_label">Password <span id='symbol_pass'></span></label>
          <input type="password" name="psw" class="form-control" id='psw' required>
        </div>
        <div class="form-group">
          <label for="password2" id="conf_psw_label">Confirm Password<span id='symbol_pass_conf'></span></label>
          <input type="password" name="password2" id="conf_psw" class="form-control" value="" required>
        </div>
        <b>Captcha</b> </br><br>

    <div class="capbox" align="center">

    <div id="CaptchaDiv" align="center"></div>

    <div class="capbox-inner"  align="center">
    Type the above number:

    <input type="hidden" id="txtCaptcha">
    <input type="text" name="CaptchaInput" id="CaptchaInput" size="15"><br>

    </div>
    </div>
    <div class="form-group" style="margin-top:20px;">

    <label for="terms">
        <input type="checkbox" name="remember" id='terms' style="margin-bottom:15px"> By checking this box you agree to our <a href="#" style="color:dodgerblue">Terms & Privacy</a>
      </label>
    </div>
          <button type="submit" class="btn btn-primary">Submit</button>
      </form>
    </div>
  </div>
</div>



<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1"
    crossorigin="anonymous"></script>

    <script>

      function checkform(theform){
var why = "";

if(theform.CaptchaInput.value == ""){
why += "- Please Enter CAPTCHA Code.\n";
}
if(theform.CaptchaInput.value != ""){
if(ValidCaptcha(theform.CaptchaInput.value) == false){
why += "- The CAPTCHA Code Does Not Match.\n";
}
}
if(why != ""){
alert(why);
return false;
}

var first_errors = document.getElementById('first_errors')
var last_errors = document.getElementById('last_errors')
var pass_errors = document.getElementById('pass_errors')

if(first_errors.childNodes.length >=1 || last_errors.childNodes.length >=1 
|| pass_errors.childNodes.length >=1) return false

  if(!(agreedToCondition.checked === true)) {

    alert('Please agree to the terms and conditions')
    return false
  }


}

var a = Math.ceil(Math.random() * 9)+ '';
var b = Math.ceil(Math.random() * 9)+ '';
var c = Math.ceil(Math.random() * 9)+ '';
var d = Math.ceil(Math.random() * 9)+ '';
var e = Math.ceil(Math.random() * 9)+ '';

var code = a + b + c + d + e;
document.getElementById("txtCaptcha").value = code;
document.getElementById("CaptchaDiv").innerHTML = code;

// Validate input against the generated number
function ValidCaptcha(){
var str1 = removeSpaces(document.getElementById('txtCaptcha').value);
var str2 = removeSpaces(document.getElementById('CaptchaInput').value);
if (str1 == str2){
return true;
}else{
return false;
}
}

var agreedToCondition = document.getElementById('terms')

// Remove the spaces from the entered and generated code
function removeSpaces(string){
return string.split(' ').join('');
}

document.getElementById('first').onkeyup = ()=> {
  

  // get all the values of the form from the document object of the DOM

        var errors = document.getElementById('first_errors') 
        var firstname = document.forms['registration']['first'].value
      

        // check if the string contains characters other than a-z || A-Z

        var pattern = /[^a-z]/i

       

       // firstname should be less than 2 chars and not more than 25 chars and 



       if(firstname.length <= 2 ||  firstname.length >= 25 || firstname.match(pattern) ){

                    
           // set empty string for the symbol everytime a key is pressed




        document.getElementById('symbol_first').innerHTML = ''

        document.getElementById('first_label').style.color = 'red'
              
              // create a paragraph element and and textNode as a child

              // create list element and append text nodes as child to it 

              // elements below are appended to the div id 'errors' in DOM to show errors

        var text = document.createElement('b')
        text.appendChild(document.createTextNode('- First name'))
        var li_one = document.createElement('li')
        var li_two = document.createElement('li')
        li_one.appendChild(document.createTextNode('should be more than 2 chars'))
        li_two.appendChild(document.createTextNode('should be A-Z or a-z'))

        // check if the child node is already appended to avoid repitition of the error messages on the form

        if(errors.childNodes.length <=1 ){
        
                errors.appendChild(text) 
                errors.appendChild(li_one)
                errors.appendChild(li_two)

      }
        }

        // if the user entered firstname is valid 


        else {

               // remove the errors displayed as <p> and <li> created above

                // remove the elements until the parent element 'errors' <div> has no child

                document.getElementById('first_label').style.color = 'black'

            if(document.getElementById('first_errors').childNodes.length > 1) {
                       

                  while(errors.firstChild) {
                        errors.removeChild(errors.firstChild)
                  }
            }

            // set the green check symbol in the case the validation is successful without any errors

            document.getElementById('symbol_first').innerHTML = '&#9989;'
        }     
        
}

// same execution method as the firstname 

document.getElementById('last').onkeyup = ()=> {
        
        var errors = document.getElementById('last_errors') 
        var lastname = document.forms['registration']['last'].value

        var pattern = /[^a-z]/i


       if(lastname.length <= 2 || lastname.length >=25 || lastname.match(pattern) ){

        document.getElementById('last_label').style.color = 'red'
        document.getElementById('symbol_last').innerHTML = ''
        var text = document.createElement('b')
        text.appendChild(document.createTextNode('Last Name'))
        var li_one = document.createElement('li')
        var li_two = document.createElement('li')
        li_one.appendChild(document.createTextNode('should be more than 2 chars and less than 25 chars '))
        li_two.appendChild(document.createTextNode('should be A-Z or a-z'))

        if(errors.childNodes.length <=1 ){
        
                errors.appendChild(text) 
                errors.appendChild(li_one)
                errors.appendChild(li_two)

      }
        }
        else {


            if(document.getElementById('last_errors').childNodes.length > 1) {
                       
                       document.getElementById('last_label').style.color = 'black'

                  while(errors.firstChild) {
                        errors.removeChild(errors.firstChild)
                  }
            }
            document.getElementById('symbol_last').innerHTML = '&#9989;'
        }     

}



document.getElementById("psw").onkeyup = ()=> {


var pass = document.getElementById('psw').value
var errors = document.getElementById('pass_errors')


// check to see if password length is at least 8 characters long


  var special = new RegExp(/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/);

         var isAlphaNumeric = false

          for(var i=0; i < pass.length; i++) {

               if(!isNaN(parseInt(pass[i]))) isAlphaNumeric = true
          }

        console.log("password: " + pass)
        console.log("isAlpha : " + isAlphaNumeric)

           if(pass.length < 8 || !isAlphaNumeric) {


        document.getElementById('psw_label').style.color = 'red'   
        document.getElementById('symbol_pass').innerHTML = ''
        var text = document.createElement('b')
        text.appendChild(document.createTextNode('- Password'))
        var li_one = document.createElement('li')
        var li_two = document.createElement('li')
        li_one.appendChild(document.createTextNode('should be at least 8 characters long'))
        li_two.appendChild(document.createTextNode('should contain at least one number'))

        if(errors.childNodes.length <=1 ){
        
                errors.appendChild(text) 
                errors.appendChild(li_one)
                errors.appendChild(li_two)

      }
        }
        else {

            document.getElementById('psw_label').style.color = 'black'   

            if(document.getElementById('pass_errors').childNodes.length > 1) {
                       

                  while(errors.firstChild) {
                        errors.removeChild(errors.firstChild)
                  }
            }
            document.getElementById('symbol_pass').innerHTML = '&#9989;'

         }

}

document.getElementById("conf_psw").onkeyup = ()=> {


var pass = document.getElementById('psw').value
var conf_pass = document.getElementById('conf_psw').value
var errors = document.getElementById('pass_errors')


// check to see if password length is at least 8 characters long


  var special = new RegExp(/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/);

         var isAlphaNumeric = false

          for(var i=0; i < pass.length; i++) {

               if(!isNaN(parseInt(pass[i]))) isAlphaNumeric = true
          }

        console.log("password: " + pass)
        console.log("isAlpha : " + isAlphaNumeric)

           if(pass.length < 8 || !isAlphaNumeric || pass !== conf_pass) {


        document.getElementById('conf_psw_label').style.color = 'red'   
        document.getElementById('symbol_pass_conf').innerHTML = ''
        var text = document.createElement('b')
        text.appendChild(document.createTextNode('- Password'))
        var li_one = document.createElement('li')
        var li_two = document.createElement('li')
        var li_three = document.createElement('li')
        li_one.appendChild(document.createTextNode('should be at least 8 characters long'))
        li_two.appendChild(document.createTextNode('should contain at least one number'))
        li_three.appendChild(document.createTextNode('passwords should match'))

        if(errors.childNodes.length <=1 ){
        
                errors.appendChild(text) 
                errors.appendChild(li_one)
                errors.appendChild(li_two)
                errors.appendChild(li_three)

      }
        }
        else {

            document.getElementById('conf_psw_label').style.color = 'black'   

            if(document.getElementById('pass_errors').childNodes.length > 1) {
                       

                  while(errors.firstChild) {
                        errors.removeChild(errors.firstChild)
                  }
            }
            document.getElementById('symbol_pass_conf').innerHTML = '&#9989;'

         }

}




    </script>

</body>


</html>